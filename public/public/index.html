<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rexo Dashboard</title>
    <!-- Tailwind CSS from CDN for easy styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a2e; /* Dark purple/blue background */
            color: #e0e0e0;
        }
        /* Custom scrollbar for a sleek look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #282a44;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a4e70;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #5c628f;
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header Section -->
    <header class="bg-[#282a44] p-4 shadow-lg rounded-b-xl flex items-center justify-between">
        <div class="flex items-center space-x-4">
            <!-- Rexo Bot Logo (Inline SVG) -->
            <svg class="w-10 h-10 text-indigo-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 2a8 8 0 100 16 8 8 0 000-16zM6.5 10a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM10 13a3 3 0 100-6 3 3 0 000 6zm3.5-3a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM17 10a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
            </svg>
            <h1 class="text-3xl font-bold text-white">Rexo Dashboard</h1>
        </div>
        <div class="flex items-center space-x-4">
            <a href="YOUR_SUPPORT_SERVER_INVITE_LINK" target="_blank" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-full font-semibold transition-colors duration-200">
                Join Support
            </a>
            <a href="YOUR_BOT_INVITE_LINK" target="_blank" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-full font-semibold transition-colors duration-200">
                Add Bot
            </a>
            <span id="botStatus" class="flex items-center text-sm font-semibold">
                <span class="w-3 h-3 rounded-full bg-green-500 animate-pulse mr-2"></span>
                Bot Online
            </span>
            <button id="signOutBtn" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full font-semibold transition-colors duration-200 hidden">
                Sign Out
            </button>
        </div>
    </header>

    <!-- Main Content Area - Initially hidden -->
    <main id="dashboardView" class="flex-grow p-6 hidden animate-fadeIn">
        <div class="container mx-auto">
            <div class="mb-6 bg-[#2e3053] p-4 rounded-xl shadow-lg">
                <p class="text-sm font-medium text-gray-400">Current User ID:</p>
                <p id="userIdDisplay" class="font-mono text-xs text-indigo-400 break-all"></p>
            </div>
            <!-- Dashboard Overview Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-[#2e3053] p-6 rounded-2xl shadow-xl transition-transform duration-300 hover:scale-105 hover:shadow-2xl">
                    <h2 class="text-xl text-indigo-400 font-semibold mb-2">Servers</h2>
                    <p class="text-4xl font-extrabold text-white" id="serverCount">...</p>
                    <p class="text-sm text-gray-400 mt-1">Bot is in these many servers.</p>
                </div>
                <div class="bg-[#2e3053] p-6 rounded-2xl shadow-xl transition-transform duration-300 hover:scale-105 hover:shadow-2xl">
                    <h2 class="text-xl text-indigo-400 font-semibold mb-2">Total Users</h2>
                    <p class="text-4xl font-extrabold text-white" id="userCount">...</p>
                    <p class="text-sm text-gray-400 mt-1">Total users bot can see.</p>
                </div>
                <div class="bg-[#2e3053] p-6 rounded-2xl shadow-xl transition-transform duration-300 hover:scale-105 hover:shadow-2xl">
                    <h2 class="text-xl text-indigo-400 font-semibold mb-2">Uptime</h2>
                    <p class="text-4xl font-extrabold text-white" id="uptime">...</p>
                    <p class="text-sm text-gray-400 mt-1">Time since last restart.</p>
                </div>
                <div class="bg-[#2e3053] p-6 rounded-2xl shadow-xl transition-transform duration-300 hover:scale-105 hover:shadow-2xl">
                    <h2 class="text-xl text-indigo-400 font-semibold mb-2">Ping</h2>
                    <p class="text-4xl font-extrabold text-white" id="ping">...</p>
                    <p class="text-sm text-gray-400 mt-1">Bot's latency to Discord.</p>
                </div>
            </div>

            <!-- Configuration Section -->
            <section class="bg-[#2e3053] p-8 rounded-2xl shadow-xl animate-fadeIn">
                <h2 class="text-2xl font-bold text-white mb-6">Server Configuration</h2>
                <div class="space-y-6">
                    <div class="flex items-center justify-between bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <div>
                            <p class="text-white font-semibold">Anti-Nuke Protection</p>
                            <p class="text-gray-400 text-sm">Prevents malicious users from deleting channels and roles.</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="antiNukeToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>
                    
                    <div class="flex items-center justify-between bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <div>
                            <p class="text-white font-semibold">Anti-Raid Protection</p>
                            <p class="text-gray-400 text-sm">Automatically detects and responds to raid attempts.</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="antiRaidToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>
                    
                    <div class="flex items-center justify-between bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <div>
                            <p class="text-white font-semibold">Auto-Prune Members</p>
                            <p class="text-gray-400 text-sm">Automatically removes inactive members to keep the server clean.</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="autoPruneToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>

                    <div class="flex items-center justify-between bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <div>
                            <p class="text-white font-semibold">Welcome Messages</p>
                            <p class="text-gray-400 text-sm">Sends a customizable welcome message to new members.</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="welcomeMessageToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>

                    <div class="flex items-center justify-between bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <div>
                            <p class="text-white font-semibold">Logging</p>
                            <p class="text-gray-400 text-sm">Logs moderation actions and other important server events.</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="loggingToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>

                    <div class="flex items-center justify-between bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <div>
                            <p class="text-white font-semibold">Auto-Role Management</p>
                            <p class="text-gray-400 text-sm">Automatically assigns a specific role to new members upon joining.</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="roleManagementToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>

                    <div class="flex items-center justify-between bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <div>
                            <p class="text-white font-semibold">Leveling System</p>
                            <p class="text-gray-400 text-sm">Enable a fun XP-based leveling system for your community.</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="levelingToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                        </label>
                    </div>

                    <div class="bg-[#3c3f68] p-4 rounded-xl transition-all duration-200 hover:bg-[#4a4e70]">
                        <p class="text-white font-semibold mb-2">Custom Commands</p>
                        <p class="text-gray-400 text-sm mb-4">Create, edit, or delete custom bot commands for your server.</p>
                        <button class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-xl transition-colors duration-200" onclick="showNotification('This button would open a custom commands editor.')">
                            Manage Custom Commands
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Login/Sign-up View -->
    <div id="authView" class="flex-grow flex items-center justify-center p-6 animate-fadeIn">
        <div class="bg-[#2e3053] p-8 rounded-2xl shadow-xl w-full max-w-sm text-center">
            <h2 class="text-2xl font-bold text-white mb-4">Welcome to Rexo</h2>
            <p class="text-gray-400 mb-6">Log in with your Discord account to manage your bot.</p>
            <button id="discordLoginBtn" class="w-full bg-[#5865F2] hover:bg-[#4752C4] text-white font-bold py-3 px-4 rounded-full transition-colors duration-200 flex items-center justify-center space-x-2">
                <!-- Discord Icon SVG -->
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 2457 2048" xmlns="http://www.w3.org/2000/svg">
                    <path d="M542 334q-220 3-388 174-129 128-140 338-20 404 290 536 84 37 151 51 29 11 50 25 37 25 74 61 14 12 30 29 160 162 309 238 88 47 185 47h1q115 0 217-38 116-43 206-114 115-91 193-219 14-22 35-51 44-77 75-121 21-32 50-75 5-7 14-20 2-2 11-13 145-125 210-288 38-95 56-209t-25-224q-32-156-118-245-103-100-244-110-101-7-194 34-115 50-184 135-18 20-30 33-40 45-76 86-13 16-27 33-146-24-307-24-171 0-311 20-213-92-384-297-7-8-19-14-11-7-23-11-23-9-46-13-176-35-266 11-27 15-56 39-24 23-44 51-27 34-47 62-24 33-40 54-15 19-27 35-17 21-30 38-16 22-26 36-12 16-24 35-13 21-23 44-9 22-19 44-8 23-14 47-6 24-8 47-2 17-2 36zM690 1092q-32-35-61-72-13-16-27-33-28-36-54-75-10-14-20-29-28-44-51-76-24-32-47-59-22-27-44-50-22-24-42-45-21-20-39-38-19-19-35-36-17-18-31-36-15-18-27-36-12-19-21-37-9-19-17-36-7-18-12-36-5-17-8-35-2-18-2-36-2-15 2-33-12-25-23-50-11-25-21-50-10-26-17-50-8-25-15-50-6-24-10-50-4-25-7-50-2-25-2-50q-2-25 0-50 0-41 12-70t35-50q24-21 53-33 29-11 59-11h1q105 0 205 38 100 37 186 111t147 165 64 216q-16 110-50 216-36 109-90 196-55 87-119 160-64 73-134 133-70 60-147 111-77 50-159 86-82 36-168 64-106 37-216 37-160 0-311-66-151-66-281-192-12-11-26-21-14-11-29-19-30-17-61-26-31-10-63-10-53 0-106 20-43 17-81 49-38 31-68 76-30 45-51 98-21 53-35 112-14 59-21 121-7 62-7 127q0 101 27 186 28 85 85 158 57 73 135 124 78 51 170 82 92 31 190 44 196 26 397 26 211 0 404-26 193-27 368-76 175-49 313-118 138-70 248-164 110-94 195-200 85-106 156-224 71-118 126-250 55-131 92-282 38-151 55-307 18-156-12-302-31-146-104-266-73-120-176-200-103-80-224-129-121-49-251-68-130-19-270-19-140 0-267 17-127 18-245 48-118 31-224 73-106 42-192 99-86 57-161 124-75 67-135 142-60 75-101 155-41 80-68 163-27 83-39 168-12 85-12 173 0 109 25 210t73 186q48 85 111 156 63 71 133 125 70 54 145 92 75 38 153 61 78 23 159 34 81 11 165 11 106 0 206-25t194-68q94-43 172-106 78-63 139-139 61-76 103-158 42-82 71-167 29-86 42-168 13-82 13-162 0-97-20-186-20-89-61-171-41-82-101-158-60-76-135-141-75-66-160-120-85-54-175-92-90-38-185-59zM1069 981q27-14 54-28 27-14 53-29 27-15 52-31 25-16 47-32 22-16 43-34 21-18 39-36 18-19 32-38 14-19 23-38 9-20 16-41 7-21 11-42 4-21 4-43-2-22-10-44-8-22-21-44-13-22-29-43-16-21-36-40-20-19-42-36-22-18-47-32-25-15-53-26-28-11-58-18-30-7-62-10-32-3-67-3-118 0-227 30-109 30-205 85-96 56-177 136-81 80-141 178-60 98-99 203-39 105-64 219-25 114-36 230-11 116-11 230 0 102 24 195 24 93 69 178 45 85 107 160 62 75 141 137 79 62 170 107 91 45 188 74 97 29 200 42 103 13 209 13 100 0 197-15 97-15 191-45 94-31 176-78 82-47 151-112 69-65 125-140 56-75 97-158 41-83 69-170 28-87 40-176 12-89 12-180 0-82-14-162-14-80-45-159-31-79-71-154-40-75-88-144-48-69-106-128-58-59-125-104-67-45-141-78-74-34-152-59-78-25-161-38-83-13-169-13-149 0-291 32-142 32-276 96-134 64-250 157-116 93-205 204-89 111-142 235-53 124-78 261-25 137-25 281 0 120 23 234 23 114 65 215 42 101 98 190 56 89 126 166 70 77 151 140 81 63 171 113 90 50 186 85 96 35 196 55 100 20 206 20 101 0 196-14 95-14 186-40 91-26 173-61 82-35 151-78 69-43 125-92 56-49 97-104 41-55 69-114 28-59 40-121 12-62 12-127 0-92-15-177-15-85-48-164-33-79-75-151-42-72-97-140-55-68-120-129-65-61-140-112-75-51-158-89-83-38-173-63-90-25-184-38-94-13-193-13-157 0-309 34-152 34-290 102-138 69-259 161-121 92-212 208-91 116-140 245-49 129-73 268-24 139-24 284zM1229 1461q0 108 55 186 54 78 141 116 87 38 186 38t186-38q87-38 141-116 55-78 55-186-1-108-56-186t-141-116q-88-38-185-38-99 0-186 38-87 38-141 116-55 78-55 186zM486 1461q0 108 55 186 54 78 141 116 87 38 186 38t186-38q87-38 141-116 55-78 55-186-1-108-56-186-54-78-141-116-88-38-185-38-99 0-186 38-87 38-141 116-55 78-55 186z"/>
                </svg>
                <span>Login with Discord</span>
            </button>
            <div id="authError" class="text-red-400 text-sm mt-4 hidden"></div>
        </div>
    </div>

    <!-- Simple Notification Message Box -->
    <div id="messageBox" class="fixed bottom-6 right-6 p-4 bg-gray-800 text-white rounded-xl shadow-lg transform translate-y-full transition-transform duration-500 ease-in-out z-50">
        <p id="messageContent"></p>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables provided by the environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // UI Elements
