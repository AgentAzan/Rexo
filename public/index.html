<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rexo Bot Control Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background: #0d1117;
        }
        
        /* Pill-style active sidebar link */
        .sidebar-link.active {
            background-color: #374151; 
            color: #38bdf8;
            font-weight: 600;
        }

        /* Hover effect for cards */
        .setting-card {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
        }
        .setting-card:hover {
            border-color: #1e40af; 
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.4);
            transform: translateY(-2px);
        }

        /* Custom scrollbar to match dark theme */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: #374151; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937; 
        }

        /* Active tab styling */
        .tab-button.active {
            color: #38bdf8; 
            border-bottom: 2px solid #38bdf8;
        }

        /* Toggle switch color */
        input:checked + div {
            background-color: #38bdf8; 
        }
    </style>
</head>
<body class="text-gray-100 min-h-screen">

    <div id="dashboard-container" class="flex h-screen overflow-hidden">
        
        <aside id="sidebar" class="w-64 bg-[#111827] text-gray-200 p-6 flex-col border-r border-gray-800 shadow-2xl hidden">
            <h1 class="text-2xl font-extrabold mb-10 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-400">
                Rexo Control
            </h1>
            <nav class="flex-1 space-y-1">
                <p class="text-xs font-semibold uppercase text-gray-500 mb-3 ml-3">Navigation</p>
                
                <a id="nav-overview" onclick="switchSection('overview')" href="#" class="sidebar-link active flex items-center p-3 rounded-xl text-sm font-medium hover:bg-gray-700 transition duration-150">
                    <i class="fas fa-desktop w-5 mr-3 text-cyan-400"></i> Overview & Stats
                </a>
                <a id="nav-servers" onclick="switchSection('servers')" href="#" class="sidebar-link flex items-center p-3 rounded-xl text-sm font-medium hover:bg-gray-700 transition duration-150">
                    <i class="fas fa-server w-5 mr-3 text-indigo-400"></i> Select Server
                </a>
                <a id="nav-settings" onclick="switchSection('settings')" href="#" class="sidebar-link flex items-center p-3 rounded-xl text-sm font-medium hover:bg-gray-700 transition duration-150">
                    <i class="fas fa-shield-alt w-5 mr-3 text-red-400"></i> Configuration
                </a>
            </nav>
            
            <div id="auth-status" class="mt-auto pt-6 border-t border-gray-800">
                <div class="flex items-center space-x-2 mb-2">
                    <i id="user-icon" class="fas fa-user-circle w-6 h-6 text-cyan-400"></i>
                    <div>
                        <p class="text-xs text-gray-400">Signed in as:</p>
                        <span id="user-id" class="text-sm font-semibold text-gray-300 truncate"></span>
                    </div>
                </div>
                <button onclick="logout()" class="w-full text-xs text-gray-400 hover:text-red-400 transition text-left mt-2">
                    <i class="fas fa-sign-out-alt mr-1"></i> Sign Out
                </button>
            </div>
        </aside>

        <main id="main-content-area" class="flex-1 overflow-y-auto p-4 sm:p-10 bg-[#0d1117] flex items-center justify-center">

            <section id="login-screen" class="w-full max-w-lg text-center bg-[#111827] p-10 rounded-2xl shadow-2xl border border-gray-800">
                <i class="fas fa-robot text-6xl text-cyan-400 mb-4"></i>
                <h2 class="text-3xl font-extrabold text-white mb-2">Rexo Bot Control Panel</h2>
                <p class="text-gray-400 mb-8">Login to manage your server's settings and view bot statistics.</p>
                
                <a href="https://discord.com/oauth2/authorize?client_id=1398582139464847411&permissions=8&integration_type=0&scope=bot+applications.commands" id="discord-login-btn" onclick="simulateDiscordLogin(event)" class="inline-flex items-center justify-center w-full px-6 py-3 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white font-semibold text-lg transition duration-150 shadow-lg transform hover:scale-[1.01]">
                    <i class="fab fa-discord mr-3"></i> Continue with Discord
                </a>

                <div class="mt-8 pt-4 border-t border-gray-800 space-y-3">
                    <a href="https://discord.com/oauth2/authorize?client_id=1398582139464847411&permissions=8&integration_type=0&scope=bot+applications.commands" target="_blank" class="text-sm text-cyan-400 hover:text-cyan-300 flex items-center justify-center">
                        <i class="fas fa-plus-circle mr-2"></i> Invite Rexo to your Server
                    </a>
                    <a href="https://discord.gg/uXWMaUdRvV" target="_blank" class="text-sm text-gray-400 hover:text-gray-300 flex items-center justify-center">
                        <i class="fas fa-headset mr-2"></i> Join Rexo Support Server
                    </a>
                </div>
            </section>
            
            <div id="dashboard-sections" class="hidden w-full h-full">
                <section id="overview-section" class="main-section space-y-10">
                    <h2 class="text-4xl font-extrabold text-white border-b border-gray-800 pb-4">
                        <i class="fas fa-chart-line text-cyan-400 mr-3"></i> Global Status
                    </h2>

                    <div id="status-card" class="bg-[#111827] p-6 rounded-2xl shadow-xl border border-gray-800">
                        <div id="ready-status" class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                 <i class="fas fa-link text-green-500 text-3xl"></i>
                                 <div>
                                     <p class="text-xl font-bold text-green-400">Mock Database Synced</p>
                                     <p class="text-sm text-gray-400">Settings are saved locally in your browser for the demo.</p>
                                 </div>
                            </div>
                            <button onclick="switchSection('settings')" class="px-6 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white font-semibold transition shadow-md">
                                Go to Settings <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-gray-800 p-5 rounded-xl shadow-lg border border-gray-700 setting-card">
                            <i class="fas fa-chart-bar text-2xl text-cyan-400 mb-3"></i>
                            <h4 class="text-sm font-medium uppercase text-gray-400">Messages Read</h4>
                            <p class="text-3xl font-bold mt-1">12.5M</p>
                        </div>
                        <div class="bg-gray-800 p-5 rounded-xl shadow-lg border border-gray-700 setting-card">
                            <i class="fas fa-user-slash text-2xl text-red-500 mb-3"></i>
                            <h4 class="text-sm font-medium uppercase text-gray-400">AutoMod Blocks</h4>
                            <p class="text-3xl font-bold mt-1">2,140</p>
                        </div>
                        <div class="bg-gray-800 p-5 rounded-xl shadow-lg border border-gray-700 setting-card">
                            <i class="fas fa-users text-2xl text-green-500 mb-3"></i>
                            <h4 class="text-sm font-medium uppercase text-gray-400">Total Users</h4>
                            <p class="text-3xl font-bold mt-1">45,123</p>
                        </div>
                        <div class="bg-gray-800 p-5 rounded-xl shadow-lg border border-gray-700 setting-card">
                            <i class="fas fa-code text-2xl text-yellow-500 mb-3"></i>
                            <h4 class="text-sm font-medium uppercase text-gray-400">Uptime (Days)</h4>
                            <p class="text-3xl font-bold mt-1">98</p>
                        </div>
                    </div>
                </section>
                
                <section id="servers-section" class="main-section hidden space-y-6">
                    <h2 class="text-4xl font-extrabold text-white border-b border-gray-800 pb-4">
                        <i class="fas fa-list-alt text-indigo-400 mr-3"></i> Active Server Selection
                    </h2>
                    <p class="text-gray-400">A proper bot dashboard uses Discord OAuth to list your servers. Here, we manage the **Global Config** file which acts as the default for all servers.</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-gray-800 p-6 rounded-2xl shadow-xl border border-blue-500/50 setting-card">
                            <div class="flex items-center mb-4">
                                <i class="fas fa-crown text-4xl text-yellow-500 mr-4"></i>
                                <div>
                                    <h4 class="text-xl font-bold text-cyan-400">Rexo Global Settings</h4>
                                    <p class="text-sm text-gray-400">Core configuration & master template.</p>
                                </div>
                            </div>
                            <button onclick="switchSection('settings')" class="w-full px-5 py-2 rounded-lg bg-cyan-600 hover:bg-cyan-500 text-white font-semibold transition shadow-md">
                                <i class="fas fa-wrench mr-2"></i> Open Configuration
                            </button>
                        </div>
                        <div class="bg-gray-800 p-6 rounded-2xl shadow-lg border border-gray-700 opacity-50 cursor-not-allowed">
                              <div class="flex items-center mb-4">
                                <i class="fas fa-users text-4xl text-gray-500 mr-4"></i>
                                <div>
                                    <h4 class="text-xl font-bold text-gray-500">Community Hub (Locked)</h4>
                                    <p class="text-sm text-gray-600">Requires Discord OAuth login to access server-specific settings.</p>
                                </div>
                            </div>
                            <button disabled class="w-full px-5 py-2 rounded-lg bg-gray-700 text-gray-500 font-semibold transition">
                                Login Required
                            </button>
                        </div>
                    </div>
                </section>


                <section id="settings-section" class="main-section hidden space-y-8">
                    <h2 class="text-4xl font-extrabold text-white border-b border-gray-800 pb-4">
                        <i class="fas fa-sliders-h text-cyan-400 mr-3"></i> Bot Configuration
                    </h2>

                    <div class="bg-[#111827] p-6 rounded-2xl shadow-2xl border border-gray-800">
                        <div class="flex border-b border-gray-700 mb-8">
                            <button id="tab-general" class="tab-button flex-1 py-3 px-4 text-sm sm:text-base font-medium transition duration-150" onclick="switchTab('general')">
                                <i class="fas fa-cog mr-2"></i> General
                            </button>
                            <button id="tab-automod" class="tab-button flex-1 py-3 px-4 text-sm sm:text-base font-medium transition duration-150" onclick="switchTab('automod')">
                                <i class="fas fa-robot mr-2"></i> Auto-Moderation
                            </button>
                            <button id="tab-utility" class="tab-button flex-1 py-3 px-4 text-sm sm:text-base font-medium transition duration-150" onclick="switchTab('utility')">
                                <i class="fas fa-tools mr-2"></i> Welcome & Status
                            </button>
                        </div>
                        
                        <div id="content-general" class="tab-content space-y-6">
                            <h3 class="text-2xl font-bold text-cyan-400 mb-6">Core Settings</h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div class="bg-gray-800 p-5 rounded-xl setting-card">
                                    <label for="prefix-input" class="block text-xl font-bold text-gray-100 mb-1">Command Prefix</label>
                                    <p class="text-sm text-gray-400 mb-3">The character the bot responds to (e.g., `!` or `/`)</p>
                                    <input type="text" id="prefix-input" maxlength="4" placeholder="//"
                                            class="w-full bg-gray-900 border border-gray-700 text-white rounded-lg p-3 text-lg focus:ring-cyan-500 focus:border-cyan-500 transition duration-150"
                                            onblur="updateSetting('prefix', this.value.trim())">
                                </div>

                                <div class="bg-gray-800 p-5 rounded-xl flex justify-between items-center setting-card border-l-4 border-red-500">
                                    <div>
                                        <p class="text-xl font-bold text-red-400">Anti-Nuke Safemode</p>
                                        <p class="text-sm text-gray-400">Lock down server features against raid attempts immediately.</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer ml-4">
                                        <input type="checkbox" id="antinuke-toggle" class="sr-only peer" onchange="updateSetting('antiNukeEnabled', this.checked)">
                                        <div class="w-14 h-8 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:start-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all"></div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div id="content-automod" class="tab-content space-y-6 hidden">
                            <h3 class="text-2xl font-bold text-cyan-400 mb-6">Automated Protection</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center setting-card">
                                    <div>
                                        <p class="text-xl font-bold text-gray-200">Anti-Link/Invite</p>
                                        <p class="text-sm text-gray-400">Deletes unapproved links and Discord invites to prevent raids.</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer ml-4">
                                        <input type="checkbox" id="antilink-toggle" class="sr-only peer" onchange="updateSetting('antilinkEnabled', this.checked)">
                                        <div class="w-14 h-8 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:start-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all"></div>
                                    </label>
                                </div>
                                <div class="bg-gray-800 p-5 rounded-xl shadow-md flex justify-between items-center setting-card">
                                    <div>
                                        <p class="text-xl font-bold text-gray-200">Anti-Caps Abuse</p>
                                        <p class="text-sm text-gray-400">Stops messages that use excessive capitalization (shouting).</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer ml-4">
                                        <input type="checkbox" id="anticaps-toggle" class="sr-only peer" onchange="updateSetting('antiCapsEnabled', this.checked)">
                                        <div class="w-14 h-8 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:start-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all"></div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div id="content-utility" class="tab-content space-y-6 hidden">
                            <h3 class="text-2xl font-bold text-cyan-400 mb-6">Welcome & Presence</h3>

                                <div class="bg-gray-800 p-5 rounded-xl setting-card">
                                    <label for="bot-status-input" class="block text-xl font-bold text-gray-100 mb-1">Bot Activity Status</label>
                                    <p class="text-sm text-gray-400 mb-3">The "Playing..." message under the bot's name. (e.g., Playing with [3] servers)</p>
                                    <input type="text" id="bot-status-input" placeholder="Playing //help | Protecting [X] servers"
                                         class="w-full bg-gray-900 border border-gray-700 text-white rounded-lg p-3 text-base focus:ring-cyan-500 focus:border-cyan-500 transition duration-150 ease-in-out"
                                         onblur="updateSetting('botStatus', this.value.trim())">
                                </div>

                                <div class="bg-gray-800 p-5 rounded-xl setting-card">
                                    <label for="welcome-message-input" class="block text-xl font-bold text-gray-100 mb-1">Welcome Message Template</label>
                                    <p class="text-sm text-gray-400 mb-3">The message sent when a user joins. Use <code>[user]</code> for the mention.</p>
                                    <textarea id="welcome-message-input" rows="3" placeholder="Welcome [user] to the server! Read the #rules"
                                        class="w-full bg-gray-900 border border-gray-700 text-white rounded-lg p-3 text-base focus:ring-cyan-500 focus:border-cyan-500 transition duration-150 ease-in-out resize-none"
                                        onblur="updateSetting('welcomeMessage', this.value.trim())"></textarea>
                                </div>
                        </div>

                        <div id="message-box" class="mt-8 p-3 text-center rounded-lg text-sm transition-opacity duration-300 opacity-0 invisible" role="alert"></div>

                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        // --- UI Element Mapping ---
        const sidebarEl = document.getElementById('sidebar');
        const loginScreenEl = document.getElementById('login-screen');
        const dashboardSectionsEl = document.getElementById('dashboard-sections');
        const userIdEl = document.getElementById('user-id');
        const messageBoxEl = document.getElementById('message-box');
        
        // --- Mock Data (Stored/Retrieved Locally) ---
        const MOCK_CONFIG = {
            prefix: '//',
            antiNukeEnabled: false,
            antilinkEnabled: true,
            antiCapsEnabled: false,
            botStatus: 'Playing //help | Protecting [X] servers',
            welcomeMessage: 'Welcome [user] to the server! Read the #rules',
        };

        function getLocalConfig() {
            try {
                const stored = localStorage.getItem('rexo_config');
                return stored ? JSON.parse(stored) : MOCK_CONFIG;
            } catch {
                return MOCK_CONFIG;
            }
        }

        function saveLocalConfig(config) {
            localStorage.setItem('rexo_config', JSON.stringify(config));
            showMessage('Configuration saved locally!', 'success');
        }


        // --- UI Manipulation Functions (kept from previous versions) ---

        window.switchSection = (sectionName) => {
            document.querySelectorAll('.main-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });

            document.getElementById(`${sectionName}-section`).classList.remove('hidden');
            document.getElementById(`nav-${sectionName}`).classList.add('active');
        };

        window.switchTab = (tabName) => {
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active', 'text-cyan-400');
                button.classList.add('text-gray-300', 'hover:text-cyan-400');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });

            const activeBtn = document.getElementById(`tab-${tabName}`);
            activeBtn.classList.add('active', 'text-cyan-400');
            activeBtn.classList.remove('text-gray-300', 'hover:text-cyan-400');
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
        };

        function showMessage(message, type) {
            const isSuccess = type === 'success';
            messageBoxEl.textContent = message;
            messageBoxEl.className = `mt-8 p-3 text-center rounded-lg text-sm transition-opacity duration-300 opacity-100 visible ${
                isSuccess ? 'bg-green-600 text-white' : 'bg-red-600 text-white'
            }`;
            setTimeout(() => {
                messageBoxEl.classList.replace('opacity-100', 'opacity-0');
                setTimeout(() => messageBoxEl.classList.add('invisible'), 300);
            }, 3000);
        }

        /**
         * Mocks saving a setting to local storage instead of Firebase.
         */
        window.updateSetting = (key, value) => {
            if (key === 'prefix' && (value.length === 0 || value.length > 4)) {
                showMessage('Prefix must be 1 to 4 characters long.', 'error');
                return;
            }
            
            const config = getLocalConfig();
            // Handle boolean toggles correctly
            const finalValue = (key === 'antiNukeEnabled' || key === 'antilinkEnabled' || key === 'antiCapsEnabled') ? !!value : value;
            config[key] = finalValue;
            
            saveLocalConfig(config);
        };

        /**
         * Loads settings from local storage and applies them to inputs.
         */
        function loadSettingsToUI() {
            const config = getLocalConfig();
            document.getElementById('prefix-input').value = config.prefix;
            document.getElementById('antinuke-toggle').checked = config.antiNukeEnabled;
            document.getElementById('antilink-toggle').checked = config.antilinkEnabled;
            document.getElementById('anticaps-toggle').checked = config.antiCapsEnabled;
            document.getElementById('bot-status-input').value = config.botStatus;
            document.getElementById('welcome-message-input').value = config.welcomeMessage;
        }


        // --- Login/Auth Logic (Simplified) ---

        /**
         * Simulates the Discord login process by setting a local token.
         */
        window.simulateDiscordLogin = (event) => {
             // In a real application, you would be redirected to the URL in the <a> tag's href
             // We prevent the default action here to simulate the login success without leaving the page
             event.preventDefault(); 
             showMessage('Simulating successful login from Discord...', 'success');
            
             // Set a dummy token and force the dashboard open
             localStorage.setItem('rexo_auth_token', 'simulated_logged_in_user');
            
             setTimeout(() => {
                 checkAuthAndDisplayDashboard(true, 'RexoDev#0001'); // Pass a mock username
             }, 1500);
        };

        /**
         * Clears the simulated token and returns to the login screen.
         */
        window.logout = () => {
            localStorage.removeItem('rexo_auth_token');
            // Reset UI
            sidebarEl.classList.add('hidden');
            loginScreenEl.classList.remove('hidden');
            dashboardSectionsEl.classList.add('hidden');
            userIdEl.textContent = 'Signed Out';
            showMessage('Successfully signed out.', 'success');
        };

        /**
         * Toggles UI visibility based on authentication status.
         */
        function checkAuthAndDisplayDashboard(isAuthenticated, username = 'RexoDev#0001') {
            if (isAuthenticated) {
                // Show Dashboard
                loginScreenEl.classList.add('hidden');
                sidebarEl.classList.remove('hidden');
                dashboardSectionsEl.classList.remove('hidden');
                
                // Update User Info
                const uidMock = username.replace('#', '_').toUpperCase().substring(0, 8) + '...';
                userIdEl.textContent = uidMock;
                
                // Load saved settings and set default view
                loadSettingsToUI();
                switchSection('overview');
                switchTab('general');
            } else {
                // Show Login Screen
                sidebarEl.classList.add('hidden');
                dashboardSectionsEl.classList.add('hidden');
                loginScreenEl.classList.remove('hidden');
            }
        }

        // Initial check on page load: See if the user is already "logged in"
        window.onload = () => {
             const isLoggedIn = localStorage.getItem('rexo_auth_token') !== null;
             checkAuthAndDisplayDashboard(isLoggedIn);
        };
    </script>
</body>
</html>
